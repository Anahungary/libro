---
// CommentBox.astro
// Componente para integrar CommentBox.io en tu sitio Astro

interface Props {
  projectId?: string;
  sortOrder?: 'best' | 'newest' | 'oldest';
}

const { 
  projectId = '5678187241537536-proj',
  sortOrder = 'newest'
} = Astro.props;

// Textos en español para CommentBox
const textsInSpanish = {
  "comments": "Comentarios",
  "loading": "Cargando comentarios...",
  "comments-none": "No hay comentarios aún",
  "comments-one": "1 comentario",
  "comments-multiple": "{n} comentarios",
  "best": "Destacados",
  "newest": "Más recientes",
  "oldest": "Más antiguos",
  "reply": "Responder",
  "edit": "Editar",
  "delete": "Eliminar",
  "confirm-delete": "¿Estás seguro de que quieres eliminar este comentario?",
  "post-comment": "Publicar comentario",
  "comment-placeholder": "Escribe un comentario...",
  "sign-in": "Iniciar sesión",
  "sign-out": "Cerrar sesión",
  "anonymous": "Anónimo",
  "email-replies": "Respuestas por email",
  "anonymous-checkbox": "Comentar anónimamente",
  "mod-badge": "Moderador",
  "op-badge": "OP",
  "deleted": "Este comentario ha sido eliminado",
  "posting-as": "Comentando como",
  "log-out": "cerrar sesión",
  "deleted-user": "Usuario eliminado",
  "now": "ahora",
  "today": "hoy",
  "yesterday": "ayer"
};
---

<div class="commentbox"></div>

<script define:vars={{ projectId, sortOrder, textsInSpanish }}>
    // @ts-nocheck
    const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
    
    if (!isLocalhost) {
      const script = document.createElement('script');
      script.src = 'https://unpkg.com/commentbox.io/dist/commentBox.min.js';
      script.onload = function() {
        commentBox(projectId, {
          tlcParam: 'tlc',
          sortOrder: sortOrder,
          texts: textsInSpanish
        });
      };
      document.head.appendChild(script);
    } else {
      const commentboxElement = document.querySelector('.commentbox');
      if (commentboxElement) {
        commentboxElement.innerHTML = 
          '<div style="padding: 20px; border: 1px solid #eee; text-align: center;">'+
          'Los comentarios se cargarán en el entorno de producción</div>';
      }
    }
  </script>